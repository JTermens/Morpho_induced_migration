(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     66923,       1519]
NotebookOptionsPosition[     65190,       1485]
NotebookOutlinePosition[     65608,       1502]
CellTagsIndexPosition[     65565,       1499]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"ClearAll", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SimulNames", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<1pi3_smoothdomain02\>\"", ",", "\"\<1pi2_smoothdomain02\>\""}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "pathFolder", "=", " ", 
   "\"\</home/joan/Documents/Tesi_doct/Spontaneous_tissue_motility/no_tension_\
finer/\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pathResults", " ", "=", " ", 
   RowBox[{"pathFolder", "<>", "\"\<results/\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pathData", "[", "SimulName_", "]"}], " ", ":=", " ", 
   RowBox[{"pathFolder", "<>", "SimulName"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.848402268208987*^9, 3.84840227317387*^9}, {
   3.8565051662024937`*^9, 3.856505172484617*^9}, {3.8565052238673697`*^9, 
   3.8565052289716*^9}, {3.8565057387918167`*^9, 3.8565057418170767`*^9}, {
   3.856515006197568*^9, 3.856515249108387*^9}, {3.856515352758445*^9, 
   3.856515357711494*^9}, {3.856515414680086*^9, 3.856515467752305*^9}, {
   3.856515529193469*^9, 3.85651556536231*^9}, {3.856515601637097*^9, 
   3.856515643008656*^9}, {3.856515692022662*^9, 3.856515799682764*^9}, 
   3.856519141898486*^9, 3.856522058271386*^9, {3.856610266941516*^9, 
   3.8566103371310253`*^9}, {3.856610375125929*^9, 3.856610482540341*^9}, {
   3.856610522678049*^9, 3.85661055660983*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"5970f161-2822-449d-810d-71110c0d0a0a"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{"FEM", " ", "upload"}], ",", " ", 
   RowBox[{"process", " ", "and", " ", "interpolate"}]}], "Chapter"]], "Input",
 CellChangeTimes->{{3.8196093598730116`*^9, 3.819609367395897*^9}, {
  3.856518712309124*^9, 3.856518726963851*^9}, {3.8565189733109293`*^9, 
  3.8565189939778023`*^9}},ExpressionUUID->"b0c5660f-228f-43ee-b681-\
96d200fe148e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"<<", "NDSolve`FEM`"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LoadParams", "[", 
    RowBox[{"SimulName_", ",", "gsplit_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Params", ",", " ", "Lc", ",", "La", ",", "lambda", ",", "R0", ",", 
       "Ri", ",", "cut", ",", "tau", ",", "dt", ",", "dsave"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Params", "=", 
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"FileNames", "[", 
           RowBox[{"\"\<Params.csv\>\"", ",", 
            RowBox[{"pathData", "[", "SimulName", "]"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "Lc", ",", "La", ",", "lambda", ",", "R0", ",", "Ri", ",", "cut", ",",
          "tau", ",", "dt", ",", "dsave"}], "}"}], "=", 
       RowBox[{"(", 
        RowBox[{"Params", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"SimulName", " ", "->", " ", "#"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{
        "Lc", ",", "La", ",", "lambda", ",", "R0", ",", "Ri", ",", "cut", ",",
          "tau", ",", 
         RowBox[{"dt", "*", "dsave", "*", "gsplit"}]}], "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LoadSimuls", "[", 
    RowBox[{"path_", ",", "gsplit_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "files", ",", "dat", ",", "ExpressionDat", ",", "Meshes", ",", "pxInts",
        ",", "pyInts", ",", "uxInts", ",", "uyInts", ",", "As", ",", "XYcms", 
       ",", "Vcms", ",", "sortedBCs", ",", "uMaxs"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"files", "=", 
       RowBox[{"FileNames", "[", 
        RowBox[{"\"\<Rend1*\>\"", ",", "path"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dat", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Import", "[", "#", "]"}], "&"}], "/@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"files", "[", 
           RowBox[{"[", "n", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "1", ",", 
            RowBox[{"Length", "[", "files", "]"}], ",", "gsplit"}], "}"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ExpressionDat", "=", 
       RowBox[{"ParallelMap", "[", 
        RowBox[{"Express", ",", "dat"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "Meshes", ",", "pxInts", ",", "pyInts", ",", "uxInts", ",", "uyInts", 
         ",", "As", ",", "XYcms", ",", "Vcms", ",", "sortedBCs", ",", 
         "uMaxs"}], "}"}], "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"ParallelMap", "[", 
         RowBox[{"ProcessDat", ",", "ExpressionDat"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Length", "[", "dat", "]"}], ",", "Meshes", ",", "pxInts", 
        ",", "pyInts", ",", "uxInts", ",", "uyInts", ",", "As", ",", "XYcms", 
        ",", "Vcms", ",", "sortedBCs", ",", "uMaxs"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Express", "[", "f_", "]"}], ":=", 
    RowBox[{"Partition", "[", 
     RowBox[{
      RowBox[{"ToExpression", "/@", 
       RowBox[{"StringSplit", "[", "f", "]"}]}], ",", "6"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProcessDat", "[", "f_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "dd", ",", "mesh", ",", "pxInt", ",", "pyInt", ",", "uxInt", ",", 
      "uyInt", ",", "A", ",", "XYcm", ",", "Vcm", ",", "SortedBCs", ",", 
      "uMax"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mesh", "=", 
      RowBox[{"ToElementMesh", "[", 
       RowBox[{
        RowBox[{"\"\<Coordinates\>\"", "\[Rule]", 
         RowBox[{"f", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{";;", "2"}]}], "]"}], "]"}]}], ",", 
        RowBox[{"\"\<MeshElements\>\"", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"TriangleElement", "[", 
           RowBox[{"Partition", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "f", "]"}], "]"}], ",", "3"}], "]"}], 
           "]"}], "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dd", "=", 
      RowBox[{"DeleteDuplicates", "[", "f", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pxInt", "=", 
      RowBox[{"ElementMeshInterpolation", "[", 
       RowBox[{
        RowBox[{"{", "mesh", "}"}], ",", 
        RowBox[{"dd", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
        RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pyInt", "=", 
      RowBox[{"ElementMeshInterpolation", "[", 
       RowBox[{
        RowBox[{"{", "mesh", "}"}], ",", 
        RowBox[{"dd", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "4"}], "]"}], "]"}], ",", 
        RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"uxInt", "=", 
      RowBox[{"ElementMeshInterpolation", "[", 
       RowBox[{
        RowBox[{"{", "mesh", "}"}], ",", 
        RowBox[{"dd", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "5"}], "]"}], "]"}], ",", 
        RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"uyInt", "=", 
      RowBox[{"ElementMeshInterpolation", "[", 
       RowBox[{
        RowBox[{"{", "mesh", "}"}], ",", 
        RowBox[{"dd", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "6"}], "]"}], "]"}], ",", 
        RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"A", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{"1", ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], "\[Element]", "mesh"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"XYcm", "=", 
      RowBox[{
       FractionBox["1", "A"], 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}], "\[Element]", "mesh"}]}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Vcm", "=", 
      RowBox[{
       FractionBox["1", "A"], 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"uxInt", "[", 
            RowBox[{"x", ",", "y"}], "]"}], ",", 
           RowBox[{"uyInt", "[", 
            RowBox[{"x", ",", "y"}], "]"}]}], "}"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}], "\[Element]", "mesh"}]}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"uMax", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"Map", "[", 
        RowBox[{"Norm", ",", 
         RowBox[{"dd", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"5", ";;", "6"}]}], "]"}], "]"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SortedBCs", "=", 
      RowBox[{"SortBy", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ToBoundaryMesh", "[", "mesh", "]"}], "[", 
         "\"\<Coordinates\>\"", "]"}], ",", 
        RowBox[{
         RowBox[{"ArcTan", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", "#", "]"}], "-", 
            RowBox[{"First", "[", "XYcm", "]"}]}], ",", 
           RowBox[{
            RowBox[{"Last", "[", "#", "]"}], "-", 
            RowBox[{"Last", "[", "XYcm", "]"}]}]}], "]"}], "&"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "mesh", ",", "pxInt", ",", "pyInt", ",", "uxInt", ",", "uyInt", ",", 
       "A", ",", "XYcm", ",", "Vcm", ",", "SortedBCs", ",", "uMax"}], 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.7184621053587685`*^9, 3.7184621217144146`*^9}, {
   3.7184625675892243`*^9, 3.718462583407892*^9}, {3.71846390213309*^9, 
   3.7184639613806496`*^9}, {3.7187143528244243`*^9, 
   3.7187143548902807`*^9}, {3.7188182897865744`*^9, 3.718818292360814*^9}, 
   3.7188608540697527`*^9, {3.719207281758297*^9, 3.7192072889589586`*^9}, {
   3.7192293673576775`*^9, 3.719229370521016*^9}, {3.7323556544763794`*^9, 
   3.7323557239354963`*^9}, {3.7323747518721333`*^9, 3.732374763119622*^9}, {
   3.7324236353725185`*^9, 3.732423635931446*^9}, {3.7325278752280617`*^9, 
   3.732527960243969*^9}, 3.7494795212237444`*^9, {3.7494795942266493`*^9, 
   3.749479680547109*^9}, {3.7494800347979546`*^9, 3.749480041764573*^9}, {
   3.749480140013784*^9, 3.7494801486198387`*^9}, {3.7494823043837175`*^9, 
   3.7494823392386956`*^9}, {3.750911559974561*^9, 3.750911588377004*^9}, 
   3.7509152316358805`*^9, 3.750916140326457*^9, {3.7539660080974703`*^9, 
   3.7539660157085285`*^9}, 3.7539663012270947`*^9, {3.753969122835782*^9, 
   3.7539691303689995`*^9}, {3.754048275470546*^9, 3.7540482781195235`*^9}, 
   3.754048690496936*^9, {3.756808299162784*^9, 3.756808303151126*^9}, {
   3.7570508586420617`*^9, 3.757050867435567*^9}, {3.7570570417591457`*^9, 
   3.7570570454928074`*^9}, {3.757315954298196*^9, 3.7573159866515255`*^9}, {
   3.7573338356665583`*^9, 3.757333840486475*^9}, {3.757337964304548*^9, 
   3.757337965663949*^9}, {3.760266210191921*^9, 3.760266210539096*^9}, {
   3.760284148296022*^9, 3.760284169396685*^9}, {3.76028654481203*^9, 
   3.7602865448868265`*^9}, {3.772340067888028*^9, 3.772340121267106*^9}, {
   3.772347555172984*^9, 3.7723475594413185`*^9}, {3.772509126015588*^9, 
   3.7725091297214766`*^9}, {3.772518177308778*^9, 3.7725181777685537`*^9}, {
   3.772523090053409*^9, 3.772523090492243*^9}, {3.772523146485483*^9, 
   3.7725231530987873`*^9}, {3.772525335736264*^9, 3.7725253381837187`*^9}, {
   3.7726125877497883`*^9, 3.7726125955768547`*^9}, 3.7726127041684146`*^9, 
   3.772613456731804*^9, {3.772776812468401*^9, 3.7727768333246403`*^9}, 
   3.773118572771682*^9, {3.7731191025643797`*^9, 3.7731191121527824`*^9}, 
   3.773119751794794*^9, {3.773121281803793*^9, 3.7731212827652516`*^9}, 
   3.7734130183237176`*^9, {3.818350563862629*^9, 3.818350711617839*^9}, {
   3.8188333391700563`*^9, 3.818833369922226*^9}, 3.818845656547703*^9, {
   3.8189227129344587`*^9, 3.818922743552856*^9}, 3.818924553391635*^9, {
   3.818927101077179*^9, 3.8189271073643613`*^9}, 3.818931184460273*^9, 
   3.818940853368949*^9, 3.818940888283722*^9, {3.8189419360369043`*^9, 
   3.8189419626337347`*^9}, 3.818942696698207*^9, {3.8189427901612697`*^9, 
   3.818942814994898*^9}, 3.818949480204639*^9, 3.819011612885686*^9, 
   3.8190116478780437`*^9, 3.8190138034395657`*^9, {3.8190209678161545`*^9, 
   3.8190209796141996`*^9}, {3.8190359251929603`*^9, 
   3.8190359358813767`*^9}, {3.819041051424624*^9, 3.8190410519202633`*^9}, {
   3.819128106309843*^9, 3.819128130173068*^9}, {3.8193576663062305`*^9, 
   3.819357673311491*^9}, {3.819357715572484*^9, 3.819357730263194*^9}, 
   3.819371970648015*^9, {3.8193812534925876`*^9, 3.8193812548839073`*^9}, 
   3.8193861096833816`*^9, {3.8193887403567305`*^9, 3.819388741277315*^9}, 
   3.8193955051105785`*^9, 3.8194572288686934`*^9, 3.819463328136059*^9, 
   3.819518796097404*^9, {3.8195219043748856`*^9, 3.819521906288773*^9}, 
   3.8195223273413677`*^9, 3.8195277518915987`*^9, {3.819538768992682*^9, 
   3.819538769451456*^9}, {3.8195616042476125`*^9, 3.8195616163991165`*^9}, {
   3.81956172391461*^9, 3.8195617247065225`*^9}, {3.819608953435565*^9, 
   3.81960901842278*^9}, {3.819609345906364*^9, 3.819609358809884*^9}, 
   3.819631201753377*^9, {3.8229939694868317`*^9, 3.822993975029011*^9}, {
   3.822994013287005*^9, 3.822994037617936*^9}, 3.8230794130365324`*^9, {
   3.8230816634248743`*^9, 3.823081675062356*^9}, 3.82314550129954*^9, {
   3.8231466802282124`*^9, 3.823146680511325*^9}, {3.8232590155831165`*^9, 
   3.82325901622939*^9}, {3.82360950098514*^9, 3.8236095047260895`*^9}, 
   3.823690924697729*^9, 3.8237038061888485`*^9, 3.8237655073582525`*^9, {
   3.8248030893214307`*^9, 3.8248030894341288`*^9}, 3.826286513512349*^9, 
   3.8262923241024256`*^9, 3.82757512271306*^9, 3.827890355825611*^9, {
   3.8484021539739895`*^9, 3.848402188154852*^9}, 3.8484022331925354`*^9, {
   3.848402307428924*^9, 3.848402330866704*^9}, {3.856505263701927*^9, 
   3.856505267188664*^9}, 3.856505301571566*^9, {3.8565152940765543`*^9, 
   3.856515295047378*^9}, {3.856515326919305*^9, 3.856515345630371*^9}, {
   3.856515499249959*^9, 3.856515502511429*^9}, {3.856515784287183*^9, 
   3.8565158604616833`*^9}, {3.856515965983037*^9, 3.856515992336441*^9}, {
   3.856516045079608*^9, 3.856516582193231*^9}, {3.856516639078924*^9, 
   3.856516818751726*^9}, {3.856516851528344*^9, 3.8565169513033743`*^9}, {
   3.856516989491987*^9, 3.856517000448537*^9}, {3.856517039068328*^9, 
   3.856517049859254*^9}, {3.856517174077674*^9, 3.85651720804389*^9}, {
   3.856517268050269*^9, 3.856517491776977*^9}, {3.856517653163786*^9, 
   3.856517677231835*^9}, {3.856517713596889*^9, 3.85651783675108*^9}, {
   3.856517892676916*^9, 3.8565179229182*^9}, {3.856517956415638*^9, 
   3.856517966092231*^9}, {3.856517998483203*^9, 3.856518022707447*^9}, {
   3.856518061714842*^9, 3.856518067971801*^9}, {3.856518108548517*^9, 
   3.8565181119197903`*^9}, {3.85651814209196*^9, 3.8565181537967453`*^9}, 
   3.856518192363741*^9, {3.856518252584179*^9, 3.85651849892784*^9}, {
   3.856518570527276*^9, 3.856518574676461*^9}, {3.856518637697455*^9, 
   3.8565186971050987`*^9}, {3.8565229509519367`*^9, 3.856522981749032*^9}, {
   3.856523062006103*^9, 3.856523091718656*^9}, {3.856523802770563*^9, 
   3.856523803104663*^9}, {3.856585071543923*^9, 3.856585151355596*^9}, {
   3.8565852732503843`*^9, 3.8565853410478487`*^9}, {3.856610181042124*^9, 
   3.856610184799348*^9}, {3.856610566397643*^9, 3.856610666652071*^9}, {
   3.8566107341746264`*^9, 3.856610744902297*^9}, {3.856611040549778*^9, 
   3.856611049776812*^9}, {3.8566111294441643`*^9, 3.8566111367121487`*^9}, {
   3.856611173061232*^9, 3.856611174738358*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"965a80ae-a152-4e91-b04e-6a9a24cca7e2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gsplit", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "Lc", ",", "La", ",", "lambda", ",", "R0", ",", "Ri", ",", "cut", ",", 
     "tau", ",", "\[Delta]t"}], "}"}], " ", "=", " ", 
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"LoadParams", "[", 
       RowBox[{"#", ",", "gsplit"}], "]"}], "&"}], "/@", "SimulNames"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", "Ri", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "l", ",", "Meshes", ",", "pxInts", ",", "pyInts", ",", "uxInts", ",", 
       "uyInts", ",", "As", ",", "XYcms", ",", "Vcms", ",", "sortedBCs", ",", 
       "uMaxs"}], "}"}], "=", " ", 
     RowBox[{"Transpose", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"LoadSimuls", "[", 
         RowBox[{"#", ",", "gsplit"}], "]"}], "&"}], "/@", "pathData"}], 
      "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "\"\<Number of frames:\>\"", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"StringForm", "[", 
        RowBox[{"\"\<- ``: ``\>\"", ",", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "&"}], "/@", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"SimulName", ",", "l"}], "}"}], "]"}]}], ";"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{
  3.8565187032107286`*^9, 3.856522080391636*^9, {3.856522999674181*^9, 
   3.856523040160961*^9}, {3.85658516742564*^9, 3.8565852473523207`*^9}, {
   3.8565853565983067`*^9, 3.8565853867926693`*^9}, 3.856601360813447*^9, {
   3.856602110075673*^9, 3.8566021111615763`*^9}, {3.856610674237585*^9, 
   3.8566107147914352`*^9}, {3.856610757378852*^9, 3.8566107787442827`*^9}, {
   3.856611058867949*^9, 3.856611112192192*^9}, {3.856611208318321*^9, 
   3.856611248615416*^9}},ExpressionUUID->"96142bf1-c668-487d-abc9-\
93d53ab4115b"],

Cell[BoxData[
 TemplateBox[{
  "Set", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"Association\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"Association\\\", \\\"[\\\", RowBox[{\\\"Lc\\\", \
\\\",\\\", \\\"La\\\", \\\",\\\", \\\"lambda\\\", \\\",\\\", \\\"R0\\\", \
\\\",\\\", \\\"Ri\\\", \\\",\\\", \\\"cut\\\", \\\",\\\", \\\"tau\\\", \
\\\",\\\", \\\"\[Delta]t\\\"}], \\\"]\\\"}]\\) is Protected.\"", 2, 91, 6, 
   24852106143441578949, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.856611232672406*^9},
 CellLabel->
  "During evaluation of \
In[90]:=",ExpressionUUID->"bb83a376-6db8-4e1c-83b0-4375d60f723e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"1pi3_smoothdomain02\"\>", "\[Rule]", "0.678351`"}], ",", 
   RowBox[{"\<\"1pi2_smoothdomain02\"\>", "\[Rule]", "0.710543`"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.856610716208695*^9, {3.856610752449718*^9, 3.8566107805937567`*^9}, {
   3.85661107914608*^9, 3.856611112941456*^9}, 3.856611144298695*^9, {
   3.856611188311479*^9, 3.8566112326850853`*^9}},
 CellLabel->"Out[92]=",ExpressionUUID->"51cdcecc-f661-4d2e-b9c6-60fa6f2cd7bb"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  StyleBox["Visualization", "Chapter"]}]], "Input",
 CellChangeTimes->{{3.718462851476099*^9, 
  3.718462856452295*^9}},ExpressionUUID->"bb268ec4-ffc0-49d0-abb6-\
607bf1dd5cba"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ViewMesh", "[", "SimulTag_", "]"}], ":=", 
   RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"m", "=", 
       RowBox[{"Meshes", "[", 
        RowBox[{"[", 
         RowBox[{"SimulTag", ",", "n"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"mr", "=", 
       RowBox[{"MeshRegion", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"mesh", "\[Equal]", "1"}], ",", 
        RowBox[{"reg", "=", 
         RowBox[{"m", "[", 
          RowBox[{"\"\<Wireframe\>\"", "[", 
           RowBox[{"\"\<MeshElementStyle\>\"", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"FaceForm", "[", 
               RowBox[{"(*", "col", "*)"}], "None", "]"}], ",", 
              RowBox[{"EdgeForm", "[", 
               RowBox[{"Directive", "[", 
                RowBox[{
                 RowBox[{"Thickness", "[", ".003", "]"}], ",", 
                 RowBox[{"Opacity", "[", ".15", "]"}], ",", "Black"}], 
                RowBox[{"(*", 
                 RowBox[{"Darker", "[", "col", "]"}], "*)"}], "]"}], "]"}]}], 
             "]"}]}], "]"}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"mesh", "\[Equal]", "0"}], ",", 
        RowBox[{"reg", "=", 
         RowBox[{"BoundaryMeshRegion", "[", "m", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "10"}], ",", "10"}], "}"}], "}"}], ",", 
          RowBox[{"AxesOrigin", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}]}], "]"}], ",", "reg", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"m", "[", 
         RowBox[{"\"\<Wireframe\>\"", "[", 
          RowBox[{
           RowBox[{
           "\"\<MeshElement\>\"", "\[Rule]", "\"\<BoundaryElements\>\""}], 
           ",", 
           RowBox[{"\"\<MeshElementStyle\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Thickness", "[", ".005", "]"}], ",", "Black"}], 
             "}"}]}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1.5"}], ",", "1.5"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1.5"}], ",", "1.5"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", 
        RowBox[{"Background", "\[Rule]", "White"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", " ", "500"}], ",", 
        RowBox[{"AxesStyle", "\[Rule]", 
         RowBox[{"Darker", "[", 
          RowBox[{"Gray", ",", ".5"}], "]"}]}], ",", 
        RowBox[{"PlotLabel", "->", 
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"StringForm", "[", 
            RowBox[{"\"\<Simulation: ``\>\"", ",", 
             RowBox[{"SimulName", "[", 
              RowBox[{"[", "SimulTag", "]"}], "]"}]}], "]"}], ",", "14"}], 
          "]"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Grid", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"mesh", ",", "1", ",", "\"\<Mesh\>\""}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Control", "[", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1", ",", 
             RowBox[{"l", "[", 
              RowBox[{"[", "SimulTag", "]"}], "]"}], ",", "1"}], "}"}], "]"}],
           ",", "SpanFromLeft", ",", "SpanFromLeft"}], "}"}]}], "}"}], 
      "]"}]}], "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ViewMesh", "[", "1", "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.856601211258988*^9, 3.856601339097538*^9}, {
  3.856602628907089*^9, 3.856602704163332*^9}, {3.856603198297117*^9, 
  3.8566032503554583`*^9}, {3.856603319236104*^9, 3.856603321585491*^9}, {
  3.856603473802203*^9, 3.856603626250553*^9}, {3.856604579281844*^9, 
  3.856604610628788*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"ef0139d9-c8e6-465a-8ee5-5b6dd1ca9578"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`mesh$$ = 1, $CellContext`n$$ = 114, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`mesh$$], 1, "Mesh"}, {0, 1}}, {
      Hold[$CellContext`n$$], 1, 121, 1}, {
      Hold[
       Grid[{{
          Manipulate`Place[1]}, {
          Manipulate`Place[2], SpanFromLeft, SpanFromLeft}}]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = {
    500., {264., 267.8467741935484}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`mesh$$ = 1, $CellContext`n$$ = 1}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`m = 
        Part[$CellContext`Meshes, 1, $CellContext`n$$]; $CellContext`mr = 
        MeshRegion[$CellContext`m]; 
       If[$CellContext`mesh$$ == 1, $CellContext`reg = $CellContext`m[
           "Wireframe"["MeshElementStyle" -> Directive[
              FaceForm[None], 
              EdgeForm[
               Directive[
                Thickness[0.003], 
                Opacity[0.15], Black]]]]]]; 
       If[$CellContext`mesh$$ == 0, $CellContext`reg = 
         BoundaryMeshRegion[$CellContext`m]]; Show[
         ListPlot[{{-10, 10}}, AxesOrigin -> {0, 0}], $CellContext`reg, 
         $CellContext`m[
          "Wireframe"["MeshElement" -> "BoundaryElements", "MeshElementStyle" -> {
             Thickness[0.005], Black}]], 
         PlotRange -> {{-1.5, 1.5}, {-1.5, 1.5}}, AspectRatio -> Automatic, 
         Background -> White, ImageSize -> 500, AxesStyle -> 
         Darker[Gray, 0.5], PlotLabel -> Style[
           StringForm["Simulation: ``", 
            Part[$CellContext`SimulName, 1]], 14]]), 
      "Specifications" :> {{{$CellContext`mesh$$, 1, "Mesh"}, {0, 1}, 
         ControlPlacement -> 1}, {$CellContext`n$$, 1, 121, 1, 
         ControlPlacement -> 2}, 
        Grid[{{
           Manipulate`Place[1]}, {
           Manipulate`Place[2], SpanFromLeft, SpanFromLeft}}]}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{546., {315.1875, 320.8125}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.856603627494878*^9, 3.856604706965515*^9},
 CellLabel->"Out[93]=",ExpressionUUID->"6820f56f-7689-4e9b-88a1-078073cc287c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"col", "=", 
    RowBox[{"Lighter", "[", 
     RowBox[{
      RowBox[{"ColorData", "[", 
       RowBox[{"95", ",", "1"}], "]"}], ",", ".3"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ViewSimul", "[", "SimulTag_", "]"}], ":=", 
   RowBox[{"Manipulate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"m", "=", 
       RowBox[{"Meshes", "[", 
        RowBox[{"[", 
         RowBox[{"SimulTag", ",", "n"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"mr", "=", 
       RowBox[{"MeshRegion", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"mesh", "==", "1"}], ",", 
        RowBox[{"reg", "=", 
         RowBox[{"m", "[", 
          RowBox[{"\"\<Wireframe\>\"", "[", 
           RowBox[{"\"\<MeshElementStyle\>\"", "->", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"FaceForm", "[", 
               RowBox[{"(*", "col", "*)"}], "None", "]"}], ",", 
              RowBox[{"EdgeForm", "[", 
               RowBox[{"Directive", "[", 
                RowBox[{
                 RowBox[{"Thickness", "[", ".003", "]"}], ",", 
                 RowBox[{"Opacity", "[", ".15", "]"}], ",", "Black"}], 
                RowBox[{"(*", 
                 RowBox[{"Darker", "[", "col", "]"}], "*)"}], "]"}], "]"}]}], 
             "]"}]}], "]"}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"mesh", "==", "0"}], ",", 
        RowBox[{"reg", "=", 
         RowBox[{"BoundaryMeshRegion", "[", "m", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"vel", "==", "1"}], ",", 
        RowBox[{"vp", "=", 
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"Graphics", "[", 
            RowBox[{"Point", "[", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], "]"}], "]"}], ",", 
           RowBox[{"Quiet", "[", 
            RowBox[{"VectorPlot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"uxInts", "[", 
                  RowBox[{"[", 
                   RowBox[{"SimulTag", ",", "n"}], "]"}], "]"}], "[", 
                 RowBox[{"x", ",", "y"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"uyInts", "[", 
                  RowBox[{"[", 
                   RowBox[{"SimulTag", ",", "n"}], "]"}], "]"}], "[", 
                 RowBox[{"x", ",", "y"}], "]"}]}], "}"}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", "y"}], "}"}], "\[Element]", "mr"}], ",", 
              RowBox[{"VectorStyle", "->", 
               RowBox[{"Darker", "[", 
                RowBox[{"Blue", ",", ".25"}], "]"}]}], ",", 
              RowBox[{"VectorScale", "->", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"0.2", " ", 
                  RowBox[{
                   RowBox[{"uMaxs", "[", 
                    RowBox[{"[", 
                    RowBox[{"SimulTag", ",", "n"}], "]"}], "]"}], "/", 
                   RowBox[{"Norm", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"3", " ", "Ri"}], ",", 
                    RowBox[{"3", " ", "Ri"}]}], "}"}], "]"}]}]}], ",", 
                 RowBox[{"Scaled", "[", "1", "]"}], ",", "Automatic"}], 
                "}"}]}], ",", 
              RowBox[{"VectorPoints", "->", "12"}]}], "]"}], "]"}]}], 
          "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"vel", "==", "0"}], ",", 
        RowBox[{"vp", "=", 
         RowBox[{"Graphics", "[", 
          RowBox[{"Point", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "10"}], ",", "10"}], "}"}], "]"}], "]"}]}]}], "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"dp", "=", 
       RowBox[{"DensityPlot", "[", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"pxInts", "[", 
               RowBox[{"[", 
                RowBox[{"SimulTag", ",", "n"}], "]"}], "]"}], "[", 
              RowBox[{"x", ",", "y"}], "]"}], ")"}], "^", "2"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"pyInts", "[", 
               RowBox[{"[", 
                RowBox[{"SimulTag", ",", "n"}], "]"}], "]"}], "[", 
              RowBox[{"x", ",", "y"}], "]"}], ")"}], "^", "2"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}], "\[Element]", "mr"}], ",", 
         RowBox[{"PlotRange", "->", "All"}], ",", 
         RowBox[{"ColorFunction", "->", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Blend", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{"Directive", "[", 
                   RowBox[{"Red", ",", 
                    RowBox[{"Opacity", "[", ".0", "]"}]}], "]"}]}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"Directive", "[", 
                   RowBox[{"Red", ",", 
                    RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], "}"}]}], 
               "}"}], ",", "#"}], "]"}], "&"}], ")"}]}], ",", 
         RowBox[{"ColorFunctionScaling", "->", "False"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Show", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "10"}], ",", "10"}], "}"}], "}"}], ",", 
          RowBox[{"AxesOrigin", "->", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}]}], "]"}], ",", 
        "\[IndentingNewLine]", "vp", ",", "\[IndentingNewLine]", "dp", ",", 
        "\[IndentingNewLine]", "reg", ",", "\[IndentingNewLine]", 
        RowBox[{"m", "[", 
         RowBox[{"\"\<Wireframe\>\"", "[", 
          RowBox[{
           RowBox[{"\"\<MeshElement\>\"", "->", "\"\<BoundaryElements\>\""}], 
           ",", 
           RowBox[{"\"\<MeshElementStyle\>\"", "->", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Thickness", "[", ".005", "]"}], ",", "Black"}], 
             "}"}]}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{"XYcms", "[", 
           RowBox[{"[", 
            RowBox[{"SimulTag", ",", 
             RowBox[{";;", "n"}]}], "]"}], "]"}], ",", 
          RowBox[{"PlotStyle", "->", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", "Thin"}], "]"}]}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1.5"}], ",", "1."}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1."}], ",", "1.5"}], "}"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"AspectRatio", "->", "Automatic"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Background", "->", "White"}], ",", "\[IndentingNewLine]", 
        RowBox[{"ImageSize", "->", "500"}], ",", "\[IndentingNewLine]", 
        RowBox[{"AxesStyle", "->", 
         RowBox[{"Darker", "[", 
          RowBox[{"Gray", ",", ".5"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Epilog", "->", 
         RowBox[{"{", 
          RowBox[{"Inset", "[", 
           RowBox[{
            RowBox[{"Framed", "[", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"Column", "[", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"StringForm", "[", 
                   RowBox[{"\"\<Time = ``\[Tau]\>\"", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "-", "1"}], ")"}], "*", 
                    RowBox[{"\[Delta]t", "[", 
                    RowBox[{"[", "SimulTag", "]"}], "]"}]}]}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"StringForm", "[", 
                   RowBox[{
                   "\"\<\[CapitalDelta]V/\\!\\(\\*SubscriptBox[\\(V\\), \
\\(0\\)]\\) = ``\>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"As", "[", 
                    RowBox[{"[", 
                    RowBox[{"SimulTag", ",", "n"}], "]"}], "]"}], "/", 
                    RowBox[{"As", "[", 
                    RowBox[{"[", 
                    RowBox[{"SimulTag", ",", "1"}], "]"}], "]"}]}], "-", 
                    "1"}], ",", "2"}], "]"}]}], "]"}]}], "}"}], "]"}], ",", 
               "14"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{".7", ",", "1."}], "}"}]}], "]"}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotLabel", "->", 
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"StringForm", "[", 
            RowBox[{"\"\<Simulation: ``\>\"", ",", 
             RowBox[{"SimulName", "[", 
              RowBox[{"[", "SimulTag", "]"}], "]"}]}], "]"}], ",", "14"}], 
          "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Grid", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Control", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"mesh", ",", "1", ",", "\"\<Mesh\>\""}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "]"}], ",", 
          RowBox[{"Control", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"vel", ",", "0", ",", "\"\<Velocity\>\""}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Control", "[", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1", ",", 
             RowBox[{"l", "[", 
              RowBox[{"[", "SimulTag", "]"}], "]"}], ",", "1"}], "}"}], "]"}],
           ",", "SpanFromLeft", ",", "SpanFromLeft"}], "}"}]}], "}"}], 
      "]"}]}], "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ViewSimul", "[", "1", "]"}], "\[IndentingNewLine]", 
 RowBox[{"ViewSimul", "[", "2", "]"}]}], "Input",
 CellChangeTimes->{{3.7184628682138023`*^9, 3.718462869414873*^9}, 
   3.718825381718408*^9, 3.7192340628499594`*^9, {3.719238604799921*^9, 
   3.7192386059029007`*^9}, {3.719238639621478*^9, 3.719238646136371*^9}, {
   3.7192386841591983`*^9, 3.719238696269569*^9}, {3.772088536772811*^9, 
   3.7720885438289404`*^9}, {3.7720886617206273`*^9, 
   3.7720886713997393`*^9}, {3.7720887213770723`*^9, 
   3.7720887330937357`*^9}, {3.7720887825953383`*^9, 3.772088803088526*^9}, {
   3.7720888507879505`*^9, 3.772088906773218*^9}, 3.7720889826073866`*^9, {
   3.772089015453537*^9, 3.772089026234703*^9}, {3.772089089770776*^9, 
   3.7720890936992636`*^9}, {3.7720891405399833`*^9, 3.772089240968379*^9}, {
   3.7720892976060147`*^9, 3.772089312523118*^9}, {3.7720893532290897`*^9, 
   3.7720893603201246`*^9}, {3.772089413069043*^9, 3.772089413943705*^9}, {
   3.7720895073010125`*^9, 3.772089617160183*^9}, {3.772089692190507*^9, 
   3.772089736325466*^9}, 3.7720897912904687`*^9, {3.772089938454855*^9, 
   3.7720899399299107`*^9}, {3.7720901536682444`*^9, 
   3.7720902086063094`*^9}, {3.7720902684552393`*^9, 
   3.7720902857978535`*^9}, {3.7720903208431244`*^9, 3.772090410896265*^9}, {
   3.7720912532840395`*^9, 3.772091258817233*^9}, {3.7720912993797503`*^9, 
   3.77209131236801*^9}, {3.772093074575326*^9, 3.77209309050073*^9}, {
   3.7720931915215416`*^9, 3.772093212288002*^9}, {3.7720933721973076`*^9, 
   3.772093373469907*^9}, {3.772094931964645*^9, 3.772094960626028*^9}, 
   3.772095010533448*^9, {3.7720950768744144`*^9, 3.772095093636754*^9}, {
   3.7720951410217056`*^9, 3.7720951429013033`*^9}, 3.772095388745718*^9, {
   3.7720961959778624`*^9, 3.772096223942425*^9}, {3.772096276779109*^9, 
   3.7720963067256823`*^9}, {3.772096418538399*^9, 3.7720964211514406`*^9}, {
   3.772096519346383*^9, 3.7720965200934286`*^9}, {3.7720966397918825`*^9, 
   3.772096656178018*^9}, 3.772096698717165*^9, {3.7720968131617174`*^9, 
   3.772096842431401*^9}, {3.772096909575701*^9, 3.772096912648674*^9}, {
   3.772097034897814*^9, 3.7720970470882025`*^9}, {3.7721650282409105`*^9, 
   3.772165089076022*^9}, {3.7721653867246733`*^9, 3.772165403584461*^9}, 
   3.7721654659460526`*^9, {3.7721656419031525`*^9, 3.772165646743986*^9}, {
   3.7721657381606984`*^9, 3.7721657742175136`*^9}, {3.772168427801922*^9, 
   3.772168435802211*^9}, {3.7722747197555146`*^9, 3.7722747215779896`*^9}, {
   3.7722753339579*^9, 3.772275362781787*^9}, {3.8484031648138475`*^9, 
   3.848403196507337*^9}, {3.848403243593089*^9, 3.848403269218285*^9}, {
   3.848403455039029*^9, 3.8484034788078847`*^9}, {3.848403563084427*^9, 
   3.8484036420007296`*^9}, {3.848403709843385*^9, 3.848403725272154*^9}, {
   3.848403806843709*^9, 3.8484038108143606`*^9}, {3.8484038495225277`*^9, 
   3.848403915739028*^9}, {3.848403969047459*^9, 3.848403976145964*^9}, {
   3.84840408241063*^9, 3.848404093351857*^9}, {3.848404153242008*^9, 
   3.8484041581380253`*^9}, {3.848404204140808*^9, 3.8484042092432127`*^9}, {
   3.8484042602535143`*^9, 3.848404266765731*^9}, {3.8484050929164977`*^9, 
   3.8484051127535515`*^9}, {3.856505351290225*^9, 3.8565053566298313`*^9}, {
   3.856505393913397*^9, 3.856505405703792*^9}, {3.856505489244191*^9, 
   3.856505490279518*^9}, {3.856505555431005*^9, 3.856505558986855*^9}, {
   3.856505592588509*^9, 3.856505596523423*^9}, 3.856505633108369*^9, {
   3.856519245952475*^9, 3.856519259664502*^9}, 3.856522039448173*^9, {
   3.856522257419756*^9, 3.856522309881496*^9}, {3.8565223873031893`*^9, 
   3.856522439512493*^9}, 3.856522503235231*^9, 3.856522556839957*^9, 
   3.856523294340448*^9, {3.856523946705164*^9, 3.856524305707589*^9}, {
   3.856585418041404*^9, 3.856585509952393*^9}, {3.856585567468336*^9, 
   3.856585568609426*^9}, {3.8565862360735703`*^9, 3.856586278650517*^9}, {
   3.85660224798346*^9, 3.856602258790531*^9}, 3.856602444914054*^9, {
   3.856602497073442*^9, 3.8566025375221033`*^9}, {3.8566025797783527`*^9, 
   3.8566025978360577`*^9}, {3.85660271470833*^9, 3.856602735871715*^9}, {
   3.856602814883469*^9, 3.85660283808982*^9}, {3.856603686988893*^9, 
   3.856603690763651*^9}, {3.8566037464740953`*^9, 3.856603828651634*^9}, 
   3.8566041460356483`*^9, {3.856604628722933*^9, 
   3.8566046531364326`*^9}},ExpressionUUID->"fae6c22c-280d-4097-93e7-\
65074e1dcafa"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`mesh$$ = 1, $CellContext`n$$ = 
    1, $CellContext`vel$$ = 0, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`mesh$$], 1, "Mesh"}, {0, 1}}, {{
       Hold[$CellContext`vel$$], 0, "Velocity"}, {0, 1}}, {
      Hold[$CellContext`n$$], 1, 121, 1}, {
      Hold[
       Grid[{{
          Manipulate`Place[1], 
          Manipulate`Place[2]}, {
          Manipulate`Place[3], SpanFromLeft, SpanFromLeft}}]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = {
    500., {264., 267.8467741935484}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`mesh$$ = 1, $CellContext`n$$ = 
        1, $CellContext`vel$$ = 0}, "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`m = 
        Part[$CellContext`Meshes, 1, $CellContext`n$$]; $CellContext`mr = 
        MeshRegion[$CellContext`m]; 
       If[$CellContext`mesh$$ == 1, $CellContext`reg = $CellContext`m[
           "Wireframe"["MeshElementStyle" -> Directive[
              FaceForm[None], 
              EdgeForm[
               Directive[
                Thickness[0.003], 
                Opacity[0.15], Black]]]]]]; 
       If[$CellContext`mesh$$ == 0, $CellContext`reg = 
         BoundaryMeshRegion[$CellContext`m]]; 
       If[$CellContext`vel$$ == 1, $CellContext`vp = Show[
           Graphics[
            Point[{0, 0}]], 
           Quiet[
            VectorPlot[{
              Part[$CellContext`uxInts, 
               1, $CellContext`n$$][$CellContext`x, $CellContext`y], 
              
              Part[$CellContext`uyInts, 
               1, $CellContext`n$$][$CellContext`x, $CellContext`y]}, 
             Element[{$CellContext`x, $CellContext`y}, $CellContext`mr], 
             VectorStyle -> Darker[Blue, 0.25], 
             VectorScale -> {
              0.2 (Part[$CellContext`uMaxs, 1, $CellContext`n$$]/
                Norm[{3 $CellContext`Ri, 3 $CellContext`Ri}]), 
               Scaled[1], Automatic}, VectorPoints -> 12]]]]; 
       If[$CellContext`vel$$ == 0, $CellContext`vp = Graphics[
           Point[{-10, 10}]]]; $CellContext`dp = DensityPlot[
          Sqrt[
          Part[$CellContext`pxInts, 
              1, $CellContext`n$$][$CellContext`x, $CellContext`y]^2 + 
           Part[$CellContext`pyInts, 
              1, $CellContext`n$$][$CellContext`x, $CellContext`y]^2], 
          Element[{$CellContext`x, $CellContext`y}, $CellContext`mr], 
          PlotRange -> All, ColorFunction -> (Blend[{{0, 
              Directive[Red, 
               Opacity[0.]]}, {1, 
              Directive[Red, 
               Opacity[1]]}}, #]& ), ColorFunctionScaling -> False]; Show[
         ListPlot[{{-10, 10}}, 
          AxesOrigin -> {0, 
           0}], $CellContext`vp, $CellContext`dp, $CellContext`reg, 
         $CellContext`m[
          "Wireframe"["MeshElement" -> "BoundaryElements", "MeshElementStyle" -> {
             Thickness[0.005], Black}]], 
         ListLinePlot[
          Part[$CellContext`XYcms, 1, 
           Span[1, $CellContext`n$$]], PlotStyle -> Directive[Black, Thin]], 
         PlotRange -> {{-1.5, 1.}, {-1., 1.5}}, AspectRatio -> Automatic, 
         Background -> White, ImageSize -> 500, AxesStyle -> 
         Darker[Gray, 0.5], Epilog -> {
           Inset[
            Framed[
             Style[
              Column[{
                StringForm[
                "Time = ``\[Tau]", ($CellContext`n$$ - 1) 
                 Part[$CellContext`\[Delta]t, 1]], 
                StringForm[
                "\[CapitalDelta]V/\!\(\*SubscriptBox[\(V\), \(0\)]\) = ``", 
                 NumberForm[
                 Part[$CellContext`As, 1, $CellContext`n$$]/
                   Part[$CellContext`As, 1, 1] - 1, 2]]}], 14]], {0.7, 1.}]}, 
         PlotLabel -> Style[
           StringForm["Simulation: ``", 
            Part[$CellContext`SimulName, 1]], 14]]), 
      "Specifications" :> {{{$CellContext`mesh$$, 1, "Mesh"}, {0, 1}, 
         ControlPlacement -> 1}, {{$CellContext`vel$$, 0, "Velocity"}, {0, 1},
          ControlPlacement -> 2}, {$CellContext`n$$, 1, 121, 1, 
         ControlPlacement -> 3}, 
        Grid[{{
           Manipulate`Place[1], 
           Manipulate`Place[2]}, {
           Manipulate`Place[3], SpanFromLeft, SpanFromLeft}}]}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{546., {315.1875, 320.8125}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.856602839173552*^9, 3.8566028499136763`*^9}, 
   3.856604150896432*^9},
 CellLabel->"Out[88]=",ExpressionUUID->"0576c3a6-63f3-49ef-ad50-86ce94b3c485"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`mesh$$ = 1, $CellContext`n$$ = 
    1, $CellContext`vel$$ = 0, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`mesh$$], 1, "Mesh"}, {0, 1}}, {{
       Hold[$CellContext`vel$$], 0, "Velocity"}, {0, 1}}, {
      Hold[$CellContext`n$$], 1, 84, 1}, {
      Hold[
       Grid[{{
          Manipulate`Place[1], 
          Manipulate`Place[2]}, {
          Manipulate`Place[3], SpanFromLeft, SpanFromLeft}}]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = {
    500., {264., 267.8467741935484}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`mesh$$ = 1, $CellContext`n$$ = 
        1, $CellContext`vel$$ = 0}, "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`m = 
        Part[$CellContext`Meshes, 2, $CellContext`n$$]; $CellContext`mr = 
        MeshRegion[$CellContext`m]; 
       If[$CellContext`mesh$$ == 1, $CellContext`reg = $CellContext`m[
           "Wireframe"["MeshElementStyle" -> Directive[
              FaceForm[None], 
              EdgeForm[
               Directive[
                Thickness[0.003], 
                Opacity[0.15], Black]]]]]]; 
       If[$CellContext`mesh$$ == 0, $CellContext`reg = 
         BoundaryMeshRegion[$CellContext`m]]; 
       If[$CellContext`vel$$ == 1, $CellContext`vp = Show[
           Graphics[
            Point[{0, 0}]], 
           Quiet[
            VectorPlot[{
              Part[$CellContext`uxInts, 
               2, $CellContext`n$$][$CellContext`x, $CellContext`y], 
              
              Part[$CellContext`uyInts, 
               2, $CellContext`n$$][$CellContext`x, $CellContext`y]}, 
             Element[{$CellContext`x, $CellContext`y}, $CellContext`mr], 
             VectorStyle -> Darker[Blue, 0.25], 
             VectorScale -> {
              0.2 (Part[$CellContext`uMaxs, 2, $CellContext`n$$]/
                Norm[{3 $CellContext`Ri, 3 $CellContext`Ri}]), 
               Scaled[1], Automatic}, VectorPoints -> 12]]]]; 
       If[$CellContext`vel$$ == 0, $CellContext`vp = Graphics[
           Point[{-10, 10}]]]; $CellContext`dp = DensityPlot[
          Sqrt[
          Part[$CellContext`pxInts, 
              2, $CellContext`n$$][$CellContext`x, $CellContext`y]^2 + 
           Part[$CellContext`pyInts, 
              2, $CellContext`n$$][$CellContext`x, $CellContext`y]^2], 
          Element[{$CellContext`x, $CellContext`y}, $CellContext`mr], 
          PlotRange -> All, ColorFunction -> (Blend[{{0, 
              Directive[Red, 
               Opacity[0.]]}, {1, 
              Directive[Red, 
               Opacity[1]]}}, #]& ), ColorFunctionScaling -> False]; Show[
         ListPlot[{{-10, 10}}, 
          AxesOrigin -> {0, 
           0}], $CellContext`vp, $CellContext`dp, $CellContext`reg, 
         $CellContext`m[
          "Wireframe"["MeshElement" -> "BoundaryElements", "MeshElementStyle" -> {
             Thickness[0.005], Black}]], 
         ListLinePlot[
          Part[$CellContext`XYcms, 2, 
           Span[1, $CellContext`n$$]], PlotStyle -> Directive[Black, Thin]], 
         PlotRange -> {{-1.5, 1.}, {-1., 1.5}}, AspectRatio -> Automatic, 
         Background -> White, ImageSize -> 500, AxesStyle -> 
         Darker[Gray, 0.5], Epilog -> {
           Inset[
            Framed[
             Style[
              Column[{
                StringForm[
                "Time = ``\[Tau]", ($CellContext`n$$ - 1) 
                 Part[$CellContext`\[Delta]t, 2]], 
                StringForm[
                "\[CapitalDelta]V/\!\(\*SubscriptBox[\(V\), \(0\)]\) = ``", 
                 NumberForm[
                 Part[$CellContext`As, 2, $CellContext`n$$]/
                   Part[$CellContext`As, 2, 1] - 1, 2]]}], 14]], {0.7, 1.}]}, 
         PlotLabel -> Style[
           StringForm["Simulation: ``", 
            Part[$CellContext`SimulName, 2]], 14]]), 
      "Specifications" :> {{{$CellContext`mesh$$, 1, "Mesh"}, {0, 1}, 
         ControlPlacement -> 1}, {{$CellContext`vel$$, 0, "Velocity"}, {0, 1},
          ControlPlacement -> 2}, {$CellContext`n$$, 1, 84, 1, 
         ControlPlacement -> 3}, 
        Grid[{{
           Manipulate`Place[1], 
           Manipulate`Place[2]}, {
           Manipulate`Place[3], SpanFromLeft, SpanFromLeft}}]}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{546., {315.1875, 320.8125}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.856602839173552*^9, 3.8566028499136763`*^9}, 
   3.856604151048367*^9},
 CellLabel->"Out[89]=",ExpressionUUID->"b130817c-8774-4401-9904-23cf5f5d8fcd"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"showframesPV", "[", "SimulTag_", "]"}], ":=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"m", "=", 
       RowBox[{"Meshes", "[", 
        RowBox[{"[", "n", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mr", "=", 
       RowBox[{"MeshRegion", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"reg", "=", 
       RowBox[{"m", "[", 
        RowBox[{"\"\<Wireframe\>\"", "[", 
         RowBox[{"\"\<MeshElementStyle\>\"", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"FaceForm", "[", 
             RowBox[{"(*", "col", "*)"}], "None", "]"}], ",", 
            RowBox[{"EdgeForm", "[", 
             RowBox[{"Directive", "[", 
              RowBox[{
               RowBox[{"Thickness", "[", ".003", "]"}], ",", 
               RowBox[{"Opacity", "[", ".15", "]"}], ",", "Black"}], 
              RowBox[{"(*", 
               RowBox[{"Darker", "[", "col", "]"}], "*)"}], "]"}], "]"}]}], 
           "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vp", "=", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"Graphics", "[", 
          RowBox[{"Point", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
         RowBox[{"Quiet", "[", 
          RowBox[{"VectorPlot", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"uxInts", "[", 
                RowBox[{"[", "n", "]"}], "]"}], "[", 
               RowBox[{"x", ",", "y"}], "]"}], ",", 
              RowBox[{
               RowBox[{"uyInts", "[", 
                RowBox[{"[", "n", "]"}], "]"}], "[", 
               RowBox[{"x", ",", "y"}], "]"}]}], "}"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", ",", "y"}], "}"}], "\[Element]", "mr"}], ",", 
            RowBox[{"VectorStyle", "\[Rule]", 
             RowBox[{"Darker", "[", 
              RowBox[{"Blue", ",", ".25"}], "]"}]}], ",", 
            RowBox[{"VectorScale", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"2", 
                FractionBox[
                 RowBox[{"uMaxs", "[", 
                  RowBox[{"[", "n", "]"}], "]"}], 
                 RowBox[{"Norm", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"3", "R0"}], ",", 
                    RowBox[{"3", "R0"}]}], "}"}], "]"}]]}], ",", 
               RowBox[{"Scaled", "[", "1", "]"}], ",", "Automatic"}], "}"}]}],
             ",", 
            RowBox[{"VectorPoints", "\[Rule]", "12"}]}], "]"}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dp", "=", 
       RowBox[{"DensityPlot", "[", 
        RowBox[{
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"pxInts", "[", 
               RowBox[{"[", "n", "]"}], "]"}], "[", 
              RowBox[{"x", ",", "y"}], "]"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"pyInts", "[", 
               RowBox[{"[", "n", "]"}], "]"}], "[", 
              RowBox[{"x", ",", "y"}], "]"}], ")"}], "2"]}]], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}], "\[Element]", "mr"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
         RowBox[{"ColorFunction", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Blend", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{"Directive", "[", 
                   RowBox[{"Red", ",", 
                    RowBox[{"Opacity", "[", ".0", "]"}]}], "]"}]}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"Directive", "[", 
                   RowBox[{"Red", ",", 
                    RowBox[{"Opacity", "[", "1", "]"}]}], "]"}]}], "}"}]}], 
               "}"}], ",", "#"}], "]"}], "&"}], ")"}]}], ",", 
         RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"Show", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "10"}], ",", "10"}], "}"}], "}"}], ",", 
          RowBox[{"AxesOrigin", "->", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}]}], "]"}], ",", 
        "\[IndentingNewLine]", "vp", ",", "\[IndentingNewLine]", "dp", ",", 
        "\[IndentingNewLine]", "reg", ",", "\[IndentingNewLine]", 
        RowBox[{"m", "[", 
         RowBox[{"\"\<Wireframe\>\"", "[", 
          RowBox[{
           RowBox[{"\"\<MeshElement\>\"", "->", "\"\<BoundaryElements\>\""}], 
           ",", 
           RowBox[{"\"\<MeshElementStyle\>\"", "->", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Thickness", "[", ".005", "]"}], ",", "Black"}], 
             "}"}]}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{"XYcms", "[", 
           RowBox[{"[", 
            RowBox[{"SimulTag", ",", 
             RowBox[{";;", "n"}]}], "]"}], "]"}], ",", 
          RowBox[{"PlotStyle", "->", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", "Thin"}], "]"}]}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1.5"}], ",", "1."}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1."}], ",", "1.5"}], "}"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"AspectRatio", "->", "Automatic"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Background", "->", "White"}], ",", "\[IndentingNewLine]", 
        RowBox[{"ImageSize", "->", "500"}], ",", "\[IndentingNewLine]", 
        RowBox[{"AxesStyle", "->", 
         RowBox[{"Darker", "[", 
          RowBox[{"Gray", ",", ".5"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Epilog", "->", 
         RowBox[{"{", 
          RowBox[{"Inset", "[", 
           RowBox[{
            RowBox[{"Framed", "[", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"Column", "[", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"StringForm", "[", 
                   RowBox[{"\"\<Time = ``\[Tau]\>\"", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "-", "1"}], ")"}], "*", 
                    RowBox[{"\[Delta]t", "[", 
                    RowBox[{"[", "SimulTag", "]"}], "]"}]}]}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"StringForm", "[", 
                   RowBox[{
                   "\"\<\[CapitalDelta]V/\\!\\(\\*SubscriptBox[\\(V\\), \
\\(0\\)]\\) = ``\>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"As", "[", 
                    RowBox[{"[", 
                    RowBox[{"SimulTag", ",", "n"}], "]"}], "]"}], "/", 
                    RowBox[{"As", "[", 
                    RowBox[{"[", 
                    RowBox[{"SimulTag", ",", "1"}], "]"}], "]"}]}], "-", 
                    "1"}], ",", "2"}], "]"}]}], "]"}]}], "}"}], "]"}], ",", 
               "14"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{".7", ",", "1."}], "}"}]}], "]"}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotLabel", "->", 
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"StringForm", "[", 
            RowBox[{"\"\<Simulation: ``\>\"", ",", 
             RowBox[{"SimulName", "[", 
              RowBox[{"[", "SimulTag", "]"}], "]"}]}], "]"}], ",", "14"}], 
          "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", "l", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7184628578016334`*^9, 3.7184628587878785`*^9}, {
   3.7184629457617702`*^9, 3.718462951685602*^9}, {3.71923873019512*^9, 
   3.719238732508982*^9}, {3.7721801459102263`*^9, 3.772180300158675*^9}, 
   3.772180696779133*^9, {3.772274736189999*^9, 3.7722747367017508`*^9}, {
   3.7722758392914286`*^9, 3.7722758459231873`*^9}, {3.8484043631926427`*^9, 
   3.848404400747306*^9}, {3.8484044332949986`*^9, 3.8484045219450183`*^9}, {
   3.848404557258499*^9, 3.8484045988527*^9}, 3.8484046560331917`*^9, 
   3.848404700213162*^9, 3.851595858441751*^9, 3.856505668551466*^9, {
   3.856603884874199*^9, 3.856603922475994*^9}, {3.8566039633974457`*^9, 
   3.856604110660548*^9}, {3.856604176460187*^9, 3.856604177570505*^9}, {
   3.856604657033934*^9, 
   3.856604666821752*^9}},ExpressionUUID->"ffec6ab2-a1af-4b5c-b0e7-\
43f1d08af93b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"ToString", "[", 
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{"pathResults", ",", 
          RowBox[{
           RowBox[{"SimulName", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "<>", "\"\<.gif\>\""}]}], "}"}], 
        "]"}], "]"}], ",", 
      RowBox[{"showframesPV", "[", 
       RowBox[{"[", "#", "]"}], "]"}], ",", 
      RowBox[{"ImageResolution", "\[Rule]", "120"}], ",", 
      RowBox[{"AnimationRepetitions", "\[Rule]", "Infinity"}], ",", " ", 
      RowBox[{"\"\<DisplayDurations\>\"", "->", ".2"}]}], "]"}], "&"}], "/@", 
   RowBox[{"Range", "[", 
    RowBox[{"Length", "[", "SimulName", "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7721804880740795`*^9, 3.7721805481982746`*^9}, {
   3.772180702918709*^9, 3.772180709509094*^9}, {3.84840482827116*^9, 
   3.8484048718071094`*^9}, 3.8565056925108337`*^9, {3.856604259956121*^9, 
   3.8566042721723013`*^9}, {3.856604407926358*^9, 
   3.8566044401379957`*^9}},ExpressionUUID->"f1088a9d-580b-4984-8340-\
384b8f926868"]
},
WindowSize->{984., 539.25},
WindowMargins->{{0, Automatic}, {0, Automatic}},
CellContext->Notebook,
FrontEndVersion->"13.0 for Linux x86 (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"80b96cb9-2806-492c-8476-a14efeca42c7"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1503, 31, 113, "Input",ExpressionUUID->"5970f161-2822-449d-810d-71110c0d0a0a"],
Cell[2064, 53, 388, 8, 56, "Input",ExpressionUUID->"b0c5660f-228f-43ee-b681-96d200fe148e"],
Cell[2455, 63, 14776, 313, 775, "Input",ExpressionUUID->"965a80ae-a152-4e91-b04e-6a9a24cca7e2"],
Cell[CellGroupData[{
Cell[17256, 380, 2121, 53, 174, "Input",ExpressionUUID->"96142bf1-c668-487d-abc9-93d53ab4115b"],
Cell[19380, 435, 622, 13, 28, "Message",ExpressionUUID->"bb83a376-6db8-4e1c-83b0-4375d60f723e"],
Cell[20005, 450, 499, 10, 33, "Output",ExpressionUUID->"51cdcecc-f661-4d2e-b9c6-60fa6f2cd7bb"]
}, Open  ]],
Cell[20519, 463, 224, 5, 63, "Input",ExpressionUUID->"bb268ec4-ffc0-49d0-abb6-607bf1dd5cba"],
Cell[CellGroupData[{
Cell[20768, 472, 4565, 111, 339, "Input",ExpressionUUID->"ef0139d9-c8e6-465a-8ee5-5b6dd1ca9578"],
Cell[25336, 585, 3120, 65, 655, "Output",ExpressionUUID->"6820f56f-7689-4e9b-88a1-078073cc287c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28493, 655, 15201, 334, 897, "Input",ExpressionUUID->"fae6c22c-280d-4097-93e7-65074e1dcafa"],
Cell[43697, 991, 5509, 118, 655, "Output",ExpressionUUID->"0576c3a6-63f3-49ef-ad50-86ce94b3c485"],
Cell[49209, 1111, 5507, 118, 655, "Output",ExpressionUUID->"b130817c-8774-4401-9904-23cf5f5d8fcd"]
}, Open  ]],
Cell[54731, 1232, 9333, 223, 696, "Input",ExpressionUUID->"ffec6ab2-a1af-4b5c-b0e7-43f1d08af93b"],
Cell[64067, 1457, 1119, 26, 51, "Input",ExpressionUUID->"f1088a9d-580b-4984-8340-384b8f926868"]
}
]
*)

